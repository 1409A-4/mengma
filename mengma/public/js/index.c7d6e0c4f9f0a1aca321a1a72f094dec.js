window.QYER||(window.QYER={uid:0}),!function(){var e=jQuery;!function(){window.qyerUtil={init:function(){window.QYER&&window.QYER.frameVersion>1&&(this._initHead(),this.spam_text_filter(),this.includeGA(),this.frameCompatibleh())},frameCompatibleh:function(){window._qyer_userid=window.QYER.uid,window.setCookie=this.setCookie,window.getCookie=this.getCookie,window._gaq=window._gaq||[]},includeGA:function(){window._gaq=window._gaq||[],window._gaq.push(["_setAccount","UA-185023-1"],["_setDomainName","qyer.com"],["_setSiteSpeedSampleRate",10],["_addIgnoredRef","qyer.com"],["_addOrganic","soso","w"],["_addOrganic","sogou","query"],["_addOrganic","baidu","word"],["_addOrganic","baidu","q1"],["_addOrganic","baidu","q2"],["_addOrganic","m.baidu","word"],["_addOrganic","so.360","q"],["_addOrganic","so","q"],["_addOrganic","baidu","w"],["_addOrganic","cn.bing","q"],["_addOrganic","sm","q"],["_trackPageview"]),"https:"==document.location.protocol?requirejs(["https://ssl.google-analytics.com/ga.js"]):requirejs(["http://qt.qyer.com/beacon.js","http://www.google-analytics.com/ga.js"])},setCookie:function(e,t,n){var i=365,o=new Date;arguments[2]||(n=1),1==n?(o.setTime(o.getTime()+24*i*60*60*1e3),document.cookie=e+"="+escape(t)+"; path=/;domain=.qyer.com;expires="+o.toGMTString()):document.cookie=e+"="+escape(t)+"; path=/;domain=.qyer.com",i=o=null},getCookie:function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return null!=t?unescape(t[2]):null},_initHead:function(){"ask.qyer.com"==window.location.hostname&&e(".qyer_header_bg").css("position","fixed")},_head:null,_getHead:function(){return this._head||(this._head=document.getElementsByTagName("head")[0]),this._head},loadCss:function(t,n){n===!1?this.insertStyle(e.ajax({url:t,async:!1}).responseText):e('<link rel="stylesheet" type="text/css" />').attr("href",t).appendTo(this._getHead())},insertStyle:function(e){var t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.innerHTML=e,this._getHead().appendChild(t),t=null},sliceArguments:function(e,t){for(var n=[],i=t;i<e.length;i++)n.push(e[i]);return n},isMobile:function(){var e=navigator.userAgent;return e.match(/Android/i)||-1!=e.indexOf("iPhone")||-1!=e.indexOf("iPad")},getWordLen:function(t,n){function i(e){if("undefined"==typeof e)return 0;var t=e.match(/[^\x00-\x80]/g);return e.length+(t?t.length:0)}function o(e){return e.replace(/[^\x00-\xff]/g,"*")}return n&&(t=o(t)),i(e.trim(t))},subStr:function(e,t){for(var n,i,o=0,r=0;r<e.length;r++)if(n=e.charAt(r),o+=encodeURI(n).length>2?1:.5,o>=t)return i=o==t?r+1:r,e.substr(0,i);return e},doTrackCode:function(t){var n="__dotarckcodebutton__";document.getElementById(n)||e('<button id="'+n+'" style="display:none;">dotarckcodebutton</button>').appendTo(document.body),e("#"+n).attr("data-bn-ipg",t).trigger("click"),n=null},ajaxFillter:function(e,t,n){if(0!=window.location.href.indexOf("http://plan.qyer.com")&&"object"==typeof e&&e.extra&&e.extra.code)switch(0|e.extra.code){case 1:window.qyerUtil.showAntiSpam(e.extra.msg)}},showAntiSpam:function(e){requirejs(["web_ct_antispam"],function(t){t.show(e)})},doAjax:function(t){var n,i,o;if(n=t.minResponseTime?new Date:null,o=function(e){if("undefined"==typeof e.error_code)try{e.error_code=e.error,e.result=e.result,0!=e.error_code&&(e.data=e.data||{},e.data.msg=e.msg)}catch(n){}0==e.error_code?("undefined"==typeof e.data&&(e.data=t.__defaultData__),t.onCallSuccessBefore&&t.onCallSuccessBefore(e),t.onSuccess&&t.onSuccess(e),t.onCallSuccessAfter&&t.onCallSuccessAfter(e)):t.onError&&t.onError(e)},t.testData)return"undefined"==typeof t.testData.data&&(t.testData.data=t.__defaultData__),void setTimeout(function(){o(t.testData)},t.minResponseTime||200);var r=window.location.host,a=t.url||t.posturl,c=t.data,s="json";if(/static.qyer.com/.test(r)===!0||/qyerstatic.com/.test(r)===!0){var u;c=e.extend({},c,{__qFED__:t.__qFED__}),t.__qFED__&&t.__qFED__.id&&(u=t.__qFED__.id,t.type="GET"),a="http://fe.2b6.me:3000/service/api/"+u,s="jsonp",api=null}var d=e.ajax({type:t.type||"POST",url:a,dataType:s,data:c,cache:t.cache||!1,success:function(e){n?(i=new Date-n,setTimeout(function(){o.call(null,e)},i>t.minResponseTime?0:t.minResponseTime-i)):o.call(null,e),n=i=null},error:function(e,n){t.onError&&t.onError({error_code:-1,__server_error__:!0,__server_status__:d.statusText,result:"error",data:{msg:n||{}}})}});return d},runOneInPeriodOfTime:function(e,t){var n;return function(i,o,r,a,c){window.clearTimeout(n),n=window.setTimeout(function(){e(i,o,r,a,c)},t||300)}},isLogin:function(){return!(!window.QYER||!window.QYER.uid)},doLogin:function(e){window.qyerUtil.isLogin()||requirejs(["web_ct_logindialog"],function(t){t.show(e)})},doSignin:function(t){requirejs(["web_ct_logindialog"],function(n){n.show(e.extend({},{page:"regist"},t))})},getUrlParam:function(e,t){var n,i=new RegExp("(^|&)"+e+"=([^&]*)(&|$)");if(t){var o=t.indexOf("?");-1!=o&&(n=t.substr(t.indexOf("?")+1))}else n=window.location.search.substr(1);if(!n)return null;var r=n.match(i);return null!=r?unescape(r[2]):null},spam_text_filter:function(){var t,n,i,o,r;t=/(http:\/\/)?[\w\.]*\.?(mafengwo\.cn|mafengwo\.com|mafengwo\.net)[a-zA-Z\/0-9&\?\.#\-_]*/gim,r=e(".qyer_spam_text_filter"),r.find("a").each(function(){n=e(this),(-1!=(n.html()+n.attr("href")).indexOf("mafengwo.cn")||-1!=(n.html()+n.attr("href")).indexOf("mafengwo.com")||-1!=(n.html()+n.attr("href")).indexOf("mafengwo.net"))&&n.replaceWith(e(this).html())}),r.each(function(){if(n=e(this),i=n.html().replace(/\<script.*?\>document\.write\(AC_FL_RunContent.*?\<\/script\>/gim,""),o=i.match(/\<img[\s\S]*?\>/gim),null!=o)for(var r=0;r<o.length;r++)i=i.replace(o[r],"[imgimg]"+r+"[/imgimg]");if(i=i.replace(t,""),null!=o)for(var r=0;r<o.length;r++)i=i.replace("[imgimg]"+r+"[/imgimg]",o[r]);n.html(i)}),t=n=i=o=r=null},openUrl:function(t){var n=e('<form action="'+t+'" target="_blank" method="get"></form>');n.appendTo(document.body),n.submit(),setTimeout(function(){n.remove(),n=null},8e3)}}}(),!function(){function e(e,t){for(var n in t)e[n]=t[n]}e(Date.prototype,{qGetWeekStr:function(){return"星期"+["日","一","二","三","四","五","六"][this.getDay()]},qAddDate:function(e){return this.setDate(this.getDate()+e),this},qToString:function(e){var t=[this.getFullYear(),this.getMonth()+1,this.getDate()];return t.join(e||"-")}}),e(String.prototype,{qToDate:function(e){var t=this.split(e||"-");t=[0|t[0],(0|t[1])-1,0|t[2]];var n=new Date(t[0],t[1],t[2]);return t.length=0,t=null,n},qToIntFixed:function(){var e=0|this;return 10>e?"0"+e:e.toString()},qToHTML:function(){return this.replace(/</gi,"&lt;").replace(/>/gi,"&gt;").replace(/\n/gi,"<br />").replace(/\t/gi,"&nbsp;&nbsp;&nbsp;&nbsp;")}})}()}(),$(function(){qyerUtil.init()});
window.Zworld=window.Zworld||{qyerUtil:{},settings:{},behaviors:{},mods:{},events:{}},window.console=window.console||{},function(t,e){Zworld.$proxy=t({}),Zworld.attachBehaviors=function(e,a){var e=e||[],n=n||Zworld.settings,a=a||"attach";t.each(e,function(){var e=this,n=t(".mod[data-mod-id="+e.id+"]");e.attach(e._$mod,n,a)})},Zworld.init=function(e,a){var e=e||[],n=n||Zworld.settings,a=a||"load";t.each(e,function(){var e=this,n=t(".mod[data-mod-id="+e.id+"]");e.init(e._$mod,n,a)})},Zworld.subscribe=function(t,a){var n=Zworld.events[t]||[];n.push(a),Zworld.events[t]=e.uniq(n)},Zworld.unsubscribe=function(t,a){var n=Zworld.events[t]||[];Zworld.events[t]=e.without(n,a)},Zworld.trigger=function(e,a){Zworld.$proxy.triggerHandler(e,a);var n=Zworld.events[e];n&&t.isArray(n)&&t.each(n,function(){var t=this,n=Zworld.mods[t]._$mod;n.triggerHandler(e,a)})},Zworld.on=function(t,e){return Zworld.$proxy.on(t,e)},Zworld.attachMod=function(e){if(!e)throw"error mod";var e=e||{},a=e.id,n=e.subscribe||[];e.load,e.attach;e._$mod=t({}),Zworld.mods[a]=e;for(var r=0,o=n.length;o>r;r++){var i=n[r];Zworld.subscribe(i,a)}},Zworld.cache={API:{addCoupon:function(t){return t.url="/bindCoupon",window.qyerUtil.doAjax(t)},searchFlight:function(t){return t.url="/flightinfo",window.qyerUtil.doAjax(t)},ajaxSubmit:function(t){return t.__qFED__={id:"2f49339d-4a5d-5b91-529e-116d16345da7",randomData:!0},window.qyerUtil.doAjax(t)}}},Zworld.toJSON=function(t){var e;try{e=JSON.parse(t)}catch(a){throw"error happend when processing data"}return e},Zworld.fixPrice=function(t){return/\.\d{2,}/.test(t)&&(t=t.toFixed(2)),t},Zworld.util={set_datepicker:function(e,a){require(["web_old_datepicker"],function(){e.size()&&e.each(function(){var e=t(this),n=e.attr("data-min"),r=e.attr("data-max"),o={},i={},d=function(t){return t+":"+(t+30)},l=function(t){return"1900:"+t};n&&(o.minDate=new Date(1e3*n),o.yearRange=d(o.minDate.getFullYear())),r&&(o.maxDate=new Date(1e3*r),o.yearRange=l(o.maxDate.getFullYear())),i=t.extend({},{changeYear:!0,changeMonth:!0,monthNamesShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],yearRange:"1900:"+((new Date).getFullYear()+30),onSelect:function(t){a&&a.onSelectCallback&&a.onSelectCallback(e,t)}},o),e.datepicker(i)})})},set_inputautocomplete:function(e,a){require(["web_old_inputautocomplete"],function(){e.size()&&e.each(function(e){var n=t(this);n.qyerAutocomplete({isAllowEmptySeach:!0,isFocusedSeach:!0,parent:n.parent()[0],onSearch:function(){var t=n.parent().find(".inputAutocomplete-hidden").html();n.qyerAutocomplete("pushHTML",t),a&&a.onSearchCallback&&a.onSearchCallback()},onSelect:function(e){var r=t(e);n.attr("data-selectkey",r.attr("data-key")).val(r.attr("data-value")),a&&a.onSelectCallback&&a.onSelectCallback(n,e)}})})})}},t(function(){var e=Zworld.mods||[];Zworld.attachBehaviors(e,"attach"),Zworld.init(e,"init"),Zworld.util.set_datepicker(t(".custom-datepicker input"),{onSelectCallback:function(t,e){"use_date"==t.parents(".input-ribbon").attr("data-key")&&(Zworld.cache.use_date=e)}}),Zworld.util.set_inputautocomplete(t('.mod-field[data-fetype$="select"] input[type="text"]'),{onSelectCallback:function(t,e){if("identity_type"==t.parents(".mod-field").attr("data-id"))for(var a=t.parents(".mod-prople"),n=a.attr("data-mod-id"),r=t.parents(".mod-"+n),o=[n+"_identity_num",n+"_identity_validity",n+"_identity_place"],i=r.find('.input-ribbon[data-key="'+n+'_identity_type"] input[type="text"]').attr("data-selectkey"),d=0,l=o.length;l>d;d++)if("99"==i)r.find(".input-ribbon[data-key='"+o[d]+"']").removeAttr("data-required").find("input").val("");else{r.find(".input-ribbon[data-key='"+o[d]+"']").attr("data-required",!0);var c=r.find('.input-ribbon[data-id="identity_num"]');if(!c.length)continue;"2"==i?c.attr("data-pattern","^((\\d{15})|(\\d{17}[\\dXx]{1}))$"):c.attr("data-pattern","^[0-9a-zA-Z]+$")}}})})}(jQuery,_);
$(function(){"use strict";var t=Zworld.cache.API;t.searchCountryCode=function(t){return t.__qFED__={id:"c6d487a6-86bd-6bfc-b40e-4e5af7b6e785",dataIndex:0},t.url="/qcross/place/ajax.php?action=SearchCountryCode",window.qyerUtil.doAjax(t)},require(["web_qui_quipopup","web_qui_quidialog","web_qui_quitip"],function(i,a,e){var n={init:function(){this.$form=$("#form"),this.$mask=$("#mask"),this.$page_hidden=$(".page-hidden"),this.$mod_unit=$(".mod-unit"),this.submit_data={},this.popup=null,this.valicode=null,this.initSubmitData(),this.initComponent(),this.bindEvt()},initSubmitData:function(){var t=this;this.submit_data={contacts:{},message:{},modules:{},coupon_style:"",coupon:""},this.$page_hidden.find("input").each(function(i){var a=$(this),e=a.attr("id"),n=a.val();t.submit_data[e]=n})},initComponent:function(){this.placeAside();var i={data:{action:"SearchCountryCode"},type:"post",onSuccess:function(t){for(var i,i,a,e,n,o,s=t.data.code,d=[],r=$("#phone-code"),n=0,o=s.length;o>n;n++)i=s[n],a=i.code.replace(/\+?(00)?/,""),e=i.name,d.push('<li data-value="'+a+'" ><a href="javascript:;">'+e+"("+a+")</a></li>");r.find(".contents > ul").html(d.join("")),s=d=i=a=n=o=null},onError:function(t){}};t.searchCountryCode(i),require(["web_old_select"],function(){$(".phone-code").qyerSelect({onChange:function(t){var i=t.getAttribute("data-value");$("#input-phone-code");$(this).qyerSelect("setTitle",i),$(this).siblings(":hidden[name=area_code]").val(t.getAttribute("data-value"))}})})},bindEvt:function(){var t=this;$(document).on("click",function(t){$(t.target).closest(".mod-field").size()<1&&$(".focus:eq(0)").removeClass("focus")}).on("click",".mod-fields .mod-field",function(){$(".focus").removeClass("focus"),$(this).addClass("focus").find(".input-hint").slideUp()}).on("focus","input",function(){$(".focus").removeClass("focus"),$(this).parents(".mod-field").addClass("focus").find(".input-hint").slideUp()}).on("click",".js-submit",function(){var i=t.validate();if(i.validate)qyerUtil.isLogin()?t.specialActivityChecker(t.submitData):require(["require_valicode"],function(i){t.valicode||(t.valicode=i.init({onConfirmCallback:function(){t.specialActivityChecker(t.submitData)}})),t.valicode.showfast()});else try{$(window).scrollTop($(".input-hint:visible").offset().top-60)}catch(a){console.log(a)}})},showTip:function(t,i){require(["web_qui_quidialog"],function(a){(new a).alert({title:"提示",text:t,type:i||"error"})})},showMask:function(){this.$mask.show()},hideMask:function(){this.$mask.hide()},getValue:function(t){var i,a,e=t.attr("data-fetype");switch(e){case"radio":var n=t.find('input[type="radio"]:checked'),i=$.trim(n.val());a={val:i,readval:n.attr("data-name")};break;case"text_time":var n=t.find('input[type="text"]'),o=$.trim(n.eq(0).val())+":"+$.trim(n.eq(1).val());a={val:":"==o?"":o,readval:":"==o?"":o};break;case"select":var n=t.find('input[type="text"]'),i=$.trim(n.val());a={val:n.attr("data-selectkey"),readval:i};break;case"input_select":var n=t.find('input[type="text"]'),i=$.trim(n.val());a={val:i,readval:i};break;case"textarea":var n=t.find("textarea"),i=$.trim(n.val());a={val:i,readval:i};break;default:var n=t.find('input[type="text"]'),i=$.trim(n.val());t.hasClass("country-code")&&(i=$.trim(t.find("#phone-code .title-text").text())+"-"+i),a={val:i,readval:i}}return a},validate:function(){var t=this,i={validate:!0,items:{}};this.initSubmitData();var a=$(".mod[data-mod-id=coupon]");return this.submit_data.coupon_style=a.attr("data-coupon-style"),this.submit_data.coupon=a.attr("data-coupon-no"),this.$mod_unit.find(".input-hint").slideUp(),this.$mod_unit.each(function(a){var e=$(this),n=e.parents(".mod"),o=n.attr("data-mod-id"),s=n.attr("data-mod-name"),d=!0,r=!1,c={mod_name:s,list:[]};if(e.is(".notice-wrapper")){var l=e.find('.custom-checkbox input[type="checkbox"]').is(":checked");return l?(d=!0,e.removeClass("error").find(".input-hint").hide()):(i.validate=d=!1,e.addClass("error").find(".input-hint").show()),!0}e.is(".mod-tourists")&&(r=!0),e.children().each(function(){var a=$(this),e=a.find(".input-ribbon:not(.ribbon-bind)"),n=a.find('.mod-bind-contact input[type="checkbox"]'),s=a.attr("data-equip-id"),l={title:a.find(".mod-title .vm").text(),content:{}};switch(n.length&&(l.is_bind=~~n.prop("checked")),r&&s&&(l.id=~~s),e.each(function(a){var e,n,o=$(this),s=o.attr("data-id"),r=o.attr("data-name"),c=(o.attr("data-fetype"),o.attr("data-required")),u=o.attr("data-pattern");e=t.getValue(o),n=$.extend({},e),o.hasClass("country-code")&&$.each(e,function(t,i){e[t]=i.split("-")[1]}),c&&"true"==c?!e.readval||$.trim(e.readval).length<1?(i.validate=d=!1,o.find(".input-hint").slideDown().find(".null").show().siblings().hide()):1!=new RegExp(u,"g").test(e.readval)&&(i.validate=d=!1,o.find(".input-hint").slideDown().find(".error").show().siblings().hide()):""!=e.readval&&1!=new RegExp(u,"g").test(e.readval)&&(i.validate=d=!1,o.find(".input-hint").slideDown().find(".error").show().siblings().hide()),o.hasClass("country-code")&&(e=n),l.content[s]={field_name:r,value:e.val,readable_value:e.readval}}),c.list.push(l),o){case"contacts":case"message":t.submit_data[o]=c;break;default:t.submit_data.modules[o]=c}})}),i},submitData:function(){var i=this,a=Zworld.cache.page_data.form_submit_url;if(a){i.showMask();var e={url:a,data:{submit_data:i.submit_data},onSuccess:function(t){i.$form.attr("action",t.data.order_url),$("#order_id").val(t.data.order_id),i.hideMask(),i.$form.submit()},onError:function(t){i.hideMask(),t.__server_error__?i.showTip("服务器错误，请稍后再试！"):1==t.error_code?window.location.href=t.data.error_url:i.showTip(t.data.msg||t.data)}};t.ajaxSubmit(e)}},placeAside:function(){var t=$(".aside"),i=$(".zw-wrapper .main");if(t.size()){var a=t.offset().top,e=t.height(),n=function(){var n=(t.offset().top,$(window).scrollTop()),o=$("body").height(),s=i.height(),d=o-a-s;return n>=a+10&&!t.hasClass("fixed")&&!t.hasClass("bottom")?void t.addClass("fixed"):a+10>n&&t.hasClass("fixed")?void t.removeClass("fixed"):d>=o-n-e&&!t.hasClass("bottom")?void t.removeClass("fixed").addClass("bottom").css("bottom",0):o-n-e>d&&t.hasClass("bottom")?void t.removeClass("bottom").addClass("fixed").css("bottom","inherit"):void 0};$(window).scroll(n)}},fillInputs:function(t,i){_.mapObject(i,function(i,a){$("#"+a,t).val(i)})},fillObject:function(t,i){return _.mapObject(t,function(t,a){return $("#"+a,i).val()})},specialActivityChecker:function(t){var i=this,a=[];_.isEmpty(a)&&t&&t.apply(i)}};n.init()})});
!function(t,e){var d=e.Zworld;t(function(){var e={$mod:t({}),$mod_prople:t(".mod-prople"),init:function(){this.bindEvent()},bindEvent:function(){var e=this;this.$mod.on("mod:update-person-check-status",function(t,d){var i=e.$mod_prople.filter('[data-mod-id="'+d.id+'"]'),a=i.attr("data-mod-num"),n=i.find(".mod-"+d.id+"[data-equip-id]").size();n==a?i.find('.input-ribbon[data-key="'+d.id+'_check_person"] input').not(":checked").attr("disabled","disabled"):i.find('.input-ribbon[data-key="'+d.id+'_check_person"] input').not(":checked").removeAttr("disabled")}),this.$mod_prople.on("input onpropertychange",".mod-people-li input",function(){var d=t(this),i=d.parents(".mod-prople").attr("data-mod-id"),a=d.parents(".mod-people-li"),n=a.find('input[type="text"]').not('[readonly="readonly"]'),r="cache"+Math.random(),o=!0;if(!(a.attr("data-equip-id")&&a.attr("data-equip-id").indexOf("cache")<0)){if(d.val()&&!a.attr("data-equip-id"))return a.attr("data-equip-id",r),void e.$mod.trigger("mod:update-person-check-status",{id:i});for(var p=0,u=n.size();u>p;p++)if(n.eq(p).val()){o=!1;break}1==o&&(a.removeAttr("data-equip-id"),e.$mod.trigger("mod:update-person-check-status",{id:i}))}}).on("change",".people-check-person input",function(i){var a=t(this),n=a.parents(".mod-prople").attr("data-mod-id"),r=a.parents(".mod-person"),o=d.toJSON(r.attr("data-person-data"));if(a.is(":checked")){var p,u=e.$mod_prople.find(".mod-"+n).not("[data-equip-id]").eq(0);u.attr("data-equip-id",o.id).find(".input-hint").slideUp(),u.find('input[type="hidden"]').val(o.id);for(var c in o){p=u.find('.input-ribbon[data-key="'+n+"_"+c+'"] input'),"radio"==p.attr("type")?p.filter('[value="'+o[c]+'"]').prop("checked","checked"):p.val(o[c]);var l=d.cache.page_data.all_identity_types||{};"identity_type"===c&&p.filter("[type='text']").attr("data-selectkey",o[c]).val(l[o[c]])}e.renderIdStatus(u,n),e.$mod.trigger("mod:update-person-check-status",{id:n}),u=p=null}else{for(var p,u=e.$mod_prople.find(".mod-"+n+'[data-equip-id="'+o.id+'"]'),s=u.removeAttr("data-equip-id").find(".input-ribbon input"),m=0,f=s.size();f>m;m++)p=s.eq(m),"radio"==p.attr("type")?p.removeAttr("checked"):void 0!=p.attr("data-selectkey")?p.attr("data-selectkey","").val(""):p.val("");e.renderIdStatus(u,n),e.$mod.trigger("mod:update-person-check-status",{id:n}),u=s=p=null}})},renderIdStatus:function(t,e){for(var d=[e+"_identity_num",e+"_identity_validity",e+"_identity_place"],i=t.find(".input-ribbon[data-key='"+e+"_identity_type'] input[type='text']").attr("data-selectkey"),a=0,n=d.length;n>a;a++)if("99"==i)t.find(".input-ribbon[data-key='"+d[a]+"']").removeAttr("data-required").find("input").val("");else{t.find(".input-ribbon[data-key='"+d[a]+"']").attr("data-required",!0);var r=t.find('.input-ribbon[data-id="identity_num"]');if(!r.length)continue;"2"==i?r.attr("data-pattern","^((\\d{15})|(\\d{17}[\\dXx]{1}))$"):r.attr("data-pattern","^[0-9a-zA-Z]+$")}}};e.init()})}(jQuery,window);
!function(t,i){var n=i.Zworld,e={};e=n.cache.API,t(function(){var i={$mod:t({}),$mod_prople_no:t(".mod-prople-no"),init:function(){this.bindEvent()},bindEvent:function(){var i=this;this.$mod.on("mod:searchFlight",function(t,r){var o,a=n.cache.use_date;a&&(o={data:{flight_no:r.flight_no,departure_date:a},onSuccess:function(t){i.$mod_prople_no.find(".pickup_arrive_time-hour").val(t.data.arrival_time.hour).end().find(".sendoff_departure_time-hour").val(t.data.departure_time.hour).end().find(".pickup_arrive_time-minute").val(t.data.arrival_time.minute).end().find(".sendoff_departure_time-minute").val(t.data.departure_time.minute)},onError:function(t){}},e.searchFlight(o))}),this.$mod_prople_no.on("blur",'.input-ribbon[data-key="pickup_flight_num"] input[type="text"],.input-ribbon[data-key="sendoff_flight_num"] input[type="text"]',function(n){var e=t(this).val();i.$mod.triggerHandler("mod:searchFlight",{flight_no:e})})},searchFlight:function(){}};i.init()})}(jQuery,window);
!function(e,i){var t,o=i.Zworld;t={id:"order",subscribe:["global:update-price"],attach:function(i,t,o){var n=t.find(".mod-prod-price-value .price"),r=t.find(".mod-prod-discounts"),c=t.find(".discounts_title");i.on("global:update-price",function(i,t){require(["project/components/buy/js/template"],function(i){e.isEmptyObject(t.price_dec)?(c.hide(),r.html("")):(c.show(),r.html(i.render("coupon_in_order",t))),n.text(t.price)})})},init:function(e,i,t){}},o.attachMod(t)}(jQuery,window);
!function(n,t){var c,i=t.Zworld;c={id:"common",subscribe:[],attach:function(n,t){},detach:function(n,t){},init:function(n,t){}},i.attachMod(c)}(jQuery,window);
!function(e,a){var t,n=a.Zworld;t={id:"message",subscribe:[],attach:function(e,a){},detach:function(e,a){},init:function(a,t){require(["web_old_textarea"],function(){var a=e(".mod-message-textarea"),t=a.find("textarea").eq(0),n=t.attr("placeholder"),i=navigator.userAgent;a.qyerTextArea({max:1e3}),i.indexOf("MSIE")>0&&(i.indexOf("MSIE 6.0")>0||i.indexOf("MSIE 7.0")>0||i.indexOf("MSIE 8.0")>0)&&(t.val(n),a.on("click",function(){t.val()==n&&t.val("")}),e(document).on("click",function(a){!e(a.target).parents(".mod[data-mod-id='message']").size()&&t.val().length<1&&t.val(n)}))})}},n.attachMod(t)}(jQuery,window);
!function(t,n){var o,a=n.Zworld,e={};e=a.cache.API,o={id:"coupon",subscribe:[],attach:function(t,n,o){},init:function(n,o,c){function i(){var t;return function(n,o){require(["web_qui_quitip"],function(a){t=t||new a,t.show({type:n,text:o})})}}function r(t){var n=o.attr("data-coupon-style");o.attr("data-coupon-style",t),"code"===t?(p.show(),l.hide(),u(n)):"ticket"===t&&(l.show(),p.hide(),u(n))}function u(t){o.trigger("clean-"+t)}var s=i(),d=t("input[name=coupon]"),p=t(".couponcode-wrapper"),l=t(".couponticket-wrapper");d.on("change",function(t){r(this.value)}),o.on("update-price",function(){var n={cid:t("#cid").val(),sum:t("#sum").val(),rooms:t("#rooms").val(),coupon_style:o.attr("data-coupon-style"),coupon:o.attr("data-coupon-no")};t.ajax({url:"/getPriceInfo",type:"post",dataType:"json",data:n,success:function(t){0===t.error_code?a.trigger("global:update-price",t.data):s("error",t.data.msg)}})}),function(){function n(t){1==t?u.addClass("loading").val("加载中..."):u.removeClass("loading").val("使用")}function a(){var a=r.val();if(""===t.trim(a))return void i.addClass("error");if(!u.hasClass("loading")){n(1);var c=o.attr("data-pid"),d=o.attr("data-price"),p={pid:c,price:d,coupon:a};t.ajax({url:"/getCouponCodeInfo",type:"post",dataType:"json",data:p,success:function(t){n(0),0===t.error_code?e(t.data):s("warning",t.data.msg)}})}}function e(t){var n=t.code;"full"==t.coupon_method?n+="<span>（满"+t.price_limit+"减"+t.price+"）</span>":"rebate"==t.coupon_method&&(n+="<span>（"+t.price_rebate+"折）</span>"),i.hide(),r.val(""),p.html(n),d.show();({price:t.price,no:t.code});o.attr("data-coupon-no",t.code),o.trigger("update-price")}function c(){i.show(),d.hide(),o.attr("data-coupon-no",""),o.trigger("update-price")}var i=t(".couponcode-bind"),r=t("#couponcode-bind-text"),u=t("#couponcode-bind-btn"),d=t(".couponcode-list"),p=t(".couponcode-text"),l=t("#couponcode-cannel-btn");u.on("click",function(){a()}),l.on("click",function(){c()}),r.on("focus",function(){i.removeClass("error")}),o.on("clean-code",function(){"none"!==d[0].style.display&&l.trigger("click")})}(),function(){function n(t){1==t?d.addClass("unfolded"):0==t&&(d.removeClass("unfolded"),d.find("input[type=text]").val(""),d.find("input[type=password]").val(""))}function a(){return d.hasClass("unfolded")}function c(){return l.hasClass("loading")}function i(t){1==t?l.addClass("loading"):0==t&&l.removeClass("loading")}function r(n){var a=t(n),e={status:a.attr("data-coupon-status"),price:a.attr("data-coupon-price"),no:a.attr("data-coupon-no")};"unavailable"!==e.status&&(a.hasClass("selected")?(a.removeClass("selected"),o.attr("data-coupon-no",""),o.trigger("update-price")):(a.addClass("selected").siblings().removeClass("selected"),o.attr("data-coupon-no",e.no),o.trigger("update-price")))}function u(){var a=o.find(".coupon-code"),c=a.find("input").val(),r=o.find(".coupon-pwd"),u=r.find("input").val(),d=o.attr("data-pid"),l=o.attr("data-price"),f=o.find("#availCouponSum"),v=parseInt(f.text())||0;if(c&&t.trim(c)){i(1);var g={data:{pid:d,price:l,coupons_id:c,coupons_pw:u},onSuccess:function(t){var a="available"==t.data.status?"添加成功":"已添加，但本订单不可用",e="available"==t.data.status?"ok":"warning",c="available"==t.data.status?".avail-coupon-content .couponticket-list":".unavail-coupon-content .couponticket-list";require(["project/components/buy/js/template"],function(n){var a=n.render("coupon",t.data);o.find(c).prepend(a).show().siblings(".couponticket-null").hide(),"available"==t.data.status&&f.html(v+1)}),n(0),s(e,a),i(0)},onError:function(t){p.addClass("error"),i(0)}};e.addCoupon(g)}else p.addClass("error")}var d=o.find(".bindcoupon-wrapper"),p=o.find(".input-container"),l=o.find(".submit-label");o.on("clean-ticket",function(){t(this).find(".coupon.selected").trigger("click")}),o.on("click",".coupon",function(t){r(this)}),o.on("click",'input[name="bind-coupon"]',function(){return a()?c()?this:void u():(n(1),this)}),p.on("click",function(){p.removeClass("error")}),t(".couponticket-tab").on("click","strong",function(n){n.preventDefault();var o=t(this),a=o.data("status");o.hasClass("current")||(t(this).addClass("current").siblings("strong").removeClass("current"),t(".couponticket-content").hide(),t("."+a+"-coupon-content").show())})}()}},a.attachMod(o)}(jQuery,window);
!function(o,c){var e,i=c.Zworld;e={id:"price",subscribe:["global:update-price"],attach:function(o,c,e){var i=c.find(".js-price"),n=c.find(".js-coupon");o.on("global:update-price",function(o,c){var e=c.price_dec.coupon,t="";e&&("full"==e.coupon_method?t+="已优惠"+e.price_down+"元":"rebate"==e.coupon_method&&(t+="已享"+e.price_rebate+"折")),i.html(c.price),n.html(t)})},init:function(o,c,e){}},i.attachMod(e)}(jQuery,window);
!function(n,t){var i,c=t.Zworld;i={id:"notice",subscribe:[],attach:function(n,t){},detach:function(n,t){},init:function(n,t){}},c.attachMod(i)}(jQuery,window);