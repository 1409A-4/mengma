var tourPage={__commScroll:function(){if($("#right_scroll").length==0){var rightHtml='<div id="right_scroll" class="right_scroll"><ul></ul></div>';$(document.body).append(rightHtml);$("#right_scroll").css({right:0,bottom:120});}},__scrollPosition:function(obj){var st=$(window).scrollTop(),winh=$(window).height(),t=$(document).scrollTop();if(t>winh){$('.toTop').removeClass("hide");}
else{$('.toTop').addClass("hide");}
if(!window.XMLHttpRequest){obj.css({"top":st+winh-winh/2,"background-attachment":"fixed","background-image":"url(about:blank)"});}},__addWeChat:function(){var $weChat=$('<li class="des"><p>扫码即领<br>150元<br>现金券</p></li><li class="erweima"><img src="http://img4.tuniucdn.com/hotel-newRightScroll/erweima.jpg?v=1"></li><li class="des-code">途牛酒店特卖</li>');addAttr($weChat);function addAttr(obj,fnshow){fnshow=obj.appendTo($("#right_scroll ul"));}},__onLineService:function(){var service=$('<li class="com-li kefu-li"><a class="onlineService" title="在线客服"><div class="kefu"></div><p class="kefu-des">在线客服</p></a></li>');addAttr(service);function addAttr(obj,fnshow){fnshow=obj.appendTo($("#right_scroll ul"));}},__addAdvise:function(){var $advise=$('<li class="com-li fankui-li"><a title="用户反馈" href="/services/advise" target="_blank"><div class="fankui"></div><p class="fankui-des">用户反馈</p></a></li>');addAttr($advise);function addAttr(obj,fnshow){fnshow=obj.appendTo($("#right_scroll ul"));}},__addHelpCenter:function(){var $help=$('<li class="com-li ques-li"><a title="帮助中心" href="http://www.tuniu.com/help/hotel_index.shtml" target="_blank"><div class="ques"></div><p class="ques-des">帮助中心</p></a></li>');addAttr($help);function addAttr(obj,fnshow){fnshow=obj.appendTo($("#right_scroll ul"));}},__backTop:function(){var backTop=$('<li class="toTop hide"><a><img src="http://img4.tuniucdn.com/hotel-newRightScroll/top.png" alt=""></a></li>');addAttr(backTop);function addAttr(obj,fnshow){fnshow=obj.appendTo($("#right_scroll ul"));}
backTop.click(function(){$("html,body").animate({scrollTop:0},"slow");});},};$(function(){tourPage.__commScroll();tourPage.__addWeChat();tourPage.__addAdvise();tourPage.__addHelpCenter();tourPage.__backTop();$(window).bind("scroll",function(){setTimeout(function(){tourPage.__scrollPosition($("#right_scroll"))
tourPage.__scrollPosition($("#right_scroll"))},500);});});;var hotelSearchBox={city:'',keywords:0,cityDefaultVal:'',keywords:'',keywordsDefaultVal:'酒店名/位置/品牌',beginDate:'',endDate:'',autoObj:null,init:function(){var This=this;this.city=$('#txtCity');this.keywords=$('#keyWord');this.beginDate=$('#begin_date');this.endDate=$('#end_date');this.city.blur(this.cityFocus);this.txtCityIconClick();this.city.change(this.cityChange);this.cityAutoComplete();this.keywords.blur(this.keywordsBlur);this.keywords.focus(this.keywordsFocus);this.popCitiesBox();this.popCityAreaInfo();this.popContentHandle();this.beginAndEndDateClick();this.submitSearch();this.mapSearch();this.getCityPoi(this.city.val());this.tipMsgClose();this.showHistory();},showHistory:function(){$('.host_list').find('dt').live({'mouseenter':function(){$(this).css('color','#49ab1e');},'mouseleave':function(){$(this).css('color','#333');}})
$('.host_list').live('click',function(){var cityName=$(this).find('dt').html();var checkdate=$(this).find('dd').html();var tmpArr=checkdate.split("至");var checkinDate=tmpArr[0];var checkoutDate=tmpArr[1];$('#txtCity').val(cityName);$('#begin_date').val(checkinDate);$('#end_date').val(checkoutDate);$(".search_host").removeClass("m_over");$(".search_addul").removeClass("m_over");$(".search_host").find("em:eq(0)").html('&#xe61f;');return false;});},tmpVal:{'cityPOICache':{}},cityFocus:function(e){var _s=hotelSearchBox;if(!$.trim(_s.city.val())){_s.city.val(_s.cityDefaultVal);}
else{if(_s.autoObj.suggestions.length){_s.city.val(_s.autoObj.suggestions[0].keyword);}}},txtCityIconClick:function(){$('#txtCity_icon').click(function(){$('#txtCity').trigger('click');});},cityChange:function(e){var _s=hotelSearchBox;$('#ct').val(1);if(!cleanCityName(_s.city.val())){$('#popCityLists').html('');_s.keywords.val(_s.keywordsDefaultVal);}else{_s.getCityPoi(_s.city.val());if(getCurrentPath()==='list'){setTimeout(function(){hotel_list.recharge();},500);}}},cityAutoComplete:function(){var _s=this;var autocomplete_options={channel:'hotel',serviceUrl:'/ajax/citySuggestion',onSelect:function(s){_s.getCityPoi(s);},selectFirst:true,isOuter:true};_s.autoObj=_s.city.autocompleteHotel(autocomplete_options);_s.city.keydown(function(){if($(".autocomplete").css("display")==="block"){$("#city_hotresults").hide();}});},keywordsBlur:function(e){var _s=hotelSearchBox;if(!$.trim(_s.keywords.val())){_s.keywords.val("酒店名/位置/品牌");}else if($.trim(_s.keywords.val())=="酒店名/位置/品牌"){_s.keywords.val('');}},keywordsFocus:function(e){var _s=hotelSearchBox;if($.trim(_s.keywords.val())=="酒店名/位置/品牌"){_s.keywords.val('');}},popCitiesBox:function(){var _s=this;_s.city.powerFloat({eventType:"click",offsets:{x:0,y:0},target:$("#city_hotresults")});},popCityAreaInfo:function(){var _s=this;_s.keywords.powerFloat({eventType:"click",offsets:{x:0,y:0},target:$("#city_keyword")});},popContentHandle:function(){var _s=this;var cityHotresults=$("#city_hotresults");var txtCity=_s.city;var keyWord=_s.keywords;var popcitylist=$('#popCity_box').find(".popcitylist");cityHotresults.find(".popcitytit").each(function(i,n){$(n).find("li").click(function(){var _this=$(this);_this.addClass("cur").siblings().removeClass("cur");popcitylist.eq(_this.index()).show().siblings().hide();});});popcitylist.find("li").click(function(){var city=$(this).text();txtCity.attr("value",city).removeClass("grey");txtCity.trigger('click');keyWord.val('');_s.getCityPoi(city);});$('#city_keyword').find('.popcitytit li').live('click',function(){var _this=$(this);_this.addClass("cur").siblings().removeClass("cur");$('#popCityLists').find('.popcitylist').eq(_this.index()).show().siblings().hide();});$('#popCityLists').find('.popcitylist').find("li").live('click',function(){keyWord.attr("value",$(this).text());keyWord.trigger('click');keyWord.removeClass("grey");});},getCityPoi:function(c){var _s=this;if(_s.tmpVal.cityPOICache[c]){_s.updateCityList(_s.tmpVal.cityPOICache[c]);_s.showPosition(_s.tmpVal.cityPOICache['position_'+c]);return false;}
$.ajax({url:'/ajax/CityPOI',type:'post',dataType:'json',data:{city:c,limit:20},success:function(s){var _str=[];var _ul_hide=['','hide','hide','hide','hide'];var _index=0;for(poi in s){_str.push('<ul class="popcitylist clearfix '+_ul_hide[_index++]+'">');var tmp=s[poi];for(p in tmp){var _poi_name=tmp[p].name?tmp[p].name:tmp[p].road_name;_str.push('<li data="'+tmp[p].id+'" class="'+(p==0?'cur':'')+'" title="'+_poi_name+'">'+_poi_name+'</li>');}
_str.push('</ul>');}
var strs=_str.join('');_s.tmpVal.cityPOICache[c]=strs;_s.tmpVal.cityPOICache['position_'+c]=s;_s.updateCityList(strs);_s.showPosition(s);},error:function(e){}});},updateCityList:function(htmlStr){$('#popCityLists').html(htmlStr);$('#city_keyword').find('.popcitytit li').eq(0).addClass('cur').siblings().removeClass('cur');},updateTitleAndCrumbs:function(){var city=$('#txtCity').val();var poi_name=$('#filter_show a.selected').text()||'';var brand_str='';$('#filter_brand a.selected').each(function(i,d){brand_str+=$(d).text()+',';});var star_name='';$('#filter_star a.selected').each(function(i,d){star_name+=$(d).text()+','});document.title=city+'酒店预订_'+city+poi_name+'附近'+brand_str+star_name+'宾馆查询_途牛';$('.crumbs').next('h1').html(city+'酒店');},beginAndEndDateClick:function(){$('#begin_date,#end_date').TN_date();$('#inDateWeek,#begin_date_icon').click(function(){$('#begin_date').trigger('focus');})
$('#outDateWeek,#end_date_icon').click(function(){$('#end_date').trigger('focus');})},submitSearch:function(){var _s=this;$('#search_hotel').click(function(e){var txtCity=_s.city;var cityValue=cleanCityName(txtCity.val());txtCity.val(cityValue);if(cityValue==""||cityValue=="城市名"){txtCity.addClass("err");if($('#com_bug_index').length){$('#com_bug_index').show();return false;}
var com_bug=$('<div id="com_bug_index" class="com_bug"><div class="w">请输入城市名称，且不可包含*&+等符号及阿拉伯数字。</div></div>');com_bug.appendTo("body");com_bug.css({top:txtCity.offset().top,left:txtCity.offset().left+270}).click(function(e){stopPropagation(e);});return false;}
var cityCode=0;if($('#popCity_box .popcitylist a[title='+cityValue+']').get(0)){cityCode=$('#popCity_box .popcitylist a[title='+cityValue+']').attr('code');}
if(!cityCode)
return false
if(_s.autoObj){var len=_s.autoObj.suggestions.length;var keywordsExists=false;for(var i=0;i<len;i++){if(cityValue==_s.autoObj.suggestions[i].keyword){keywordsExists=true;break;}}
if($('#popCity_box .popcitylist a[title='+cityValue+']').get(0)){keywordsExists=true;}
if(!keywordsExists){_s.showError('请选择合适的目的地!',txtCity);return false;}}
var date1=_s.beginDate.val();if(date1=="yyyy-mm-dd"){_s.showError('请选择入住日期!',_s.beginDate);return false;}
var date2=_s.endDate.val();if(date2=="yyyy-mm-dd"){_s.showError('请选择退房日期!',_s.endDate);return false;}
if(!validateDateLong()){stopPropagation(e);return;}
var _url='/list/'+cityCode+'p0s0b0/?checkindate='+date1+'&checkoutdate='+date2;if($('#keyWord').val()!='酒店名/位置/品牌'){_url+='&keyword='+cleanParams($('#keyWord').val());}
$('.TomJerry').text('{"system": "HotelChannel", "destination":'+$('#txtCity').val()+',"keyword:"'+$('#keyWord').val()+', "entry": "酒店详情页","checkIn":'
+$('#begin_date').val()+',"checkOut":'+$('#end_date').val()+'}');window.location.href=encodeURI(_url);return;});},mapSearch:function(){var _s=this;$('#m_MapBtn').click(function(e){var txtCity=_s.city;var cityValue=cleanCityName(txtCity.val());var _url='/maplist/'+cityValue+'p0s0b0/';window.location.href=encodeURI(_url);})},tipMsgClose:function(){var _s=this;$(document).click(function(){if($("#com_bug")){$("#com_bug").remove();$('#end_date').removeClass("err");}
if($(".search_host").hasClass("m_over")){$(".search_host").removeClass("m_over");$(".search_addul").removeClass("m_over");$(".search_host").find("em:eq(0)").html('&#xe61f;');}
if($("#com_bug_index")){$("#com_bug_index").remove();$('#txtCity').removeClass("err");}
if($("#com_bug_list")){$("#com_bug_list").remove();$('#txtCity').removeClass("err");}
_s.hideErr();})},showPosition:function(s){if(getCurrentPath()!=='list'){return;}
if('object'!==typeof s){return;}
var _index=$("#filter_position").find("dd.filter_tip.on").index();var positionType={'district':'商圈','scenic':'景点','area':'行政区','traffic':'机场/火车站','road':'道路'};var city,id,name;var tab='<p class="t_tit">位置：</p><dl><dt><a href="javascript:void(0);" class="unlimited unli">不限</a></dt>';var con='';for(var type in positionType){var tab_items='';var con_items='';if(s[type]&&s[type].length>0){tab_items='<dd class="filter_tip"><a href="javascript:void(0);">'+positionType[type]+'<span class="iconjt"></span></a></dd>';con_items='<div class="show_more hide"><ul class="clearfix">';for(var i in s[type]){id=parseInt(s[type][i]['id']);city=type==='scenic'?parseInt(s[type][i]['city_code']):parseInt(s[type][i]['poi']);name=type==='road'?s[type][i]['road_name']:s[type][i]['name'];con_items+="<li><a href='/list/"+city+'p'+id+"s0b0/' data='"+id+"' title='"+name+"' class='' onclick='return false;'>"+name+"</a></li>";}
con_items+='</ul><span class="c_close">X</span></div>';}
tab+=tab_items;con+=con_items;}
tab+='</dl>';$("#filter_position").find(".filter_tip").off();$('.show_more').find('a').off();hotel_list.tabShow();hotel_list.selectShow();if(_index>=0){$("#filter_position").find(".filter_tip").eq(_index-1).addClass('on');$("#filter_position").find(".show_more").eq(_index-1).removeClass('hide');$('.show_more').find('a').bind('click',function(){hotel_list.recharge();})}},hotelErrTips:null,showError:function(msg,target){if(!this.hotelErrTips){this.hotelErrTips=$('<div class="hotel_err_tips"><span></span></div>');$('body').append(this.hotelErrTips);}
var offset=target.offset();var left=offset.left;var top=offset.top;var h=target.outerHeight();var w=target.outerWidth();var cssObj={position:"absolute","z-index":999,background:"#ffeaea",border:"1px solid #ffabab",color:"#fb3a3a",padding:"5px",top:top+h-1+'px',left:left+'px'};this.hotelErrTips.data('target',target).css(cssObj).show().find('span').text(msg);var w2=this.hotelErrTips.outerWidth();w2<w?this.hotelErrTips.css('width',w-2-10+'px'):null;target.addClass('err');},hideErr:function(){if(this.hotelErrTips){this.hotelErrTips.data('target').removeClass('err');this.hotelErrTips.hide();}}}
var roomCompare={compareCookieName:'roomComareInfo',init:function(){this.addContrast();this.goCompare();this.initCompareList();this.hotelContrastFix();},addContrast:function(){var _this=this;$("div.hotelAll").find(".contrast").on("click",function(){var rId=$(this).attr("data");var contrastListLiLength=$("#contrastList").find("li").length
if(contrastListLiLength<2){var roomCookieInfo=readCookie(_this.compareCookieName);if($.trim(roomCookieInfo)){var roomInfo=jQuery.parseJSON($.trim(roomCookieInfo));var len=_this.countObjProperties(roomInfo)
if(len>contrastListLiLength){$("#contrastList").empty();_this.initCompareList();if(len==2){return false;}}}}
if(contrastListLiLength){var found=false;$("#contrastList").find("li").each(function(){if($(this).attr('data')==rId){found=true;return false;}});if(found){return false;}}
if(contrastListLiLength<2){$(this).addClass("add");var _li=$(this).parent().parent().eq(0);if($('#hotelName').length){var hotelName=$('#hotelName').text();}else{var hotelName=$(this).attr("chotelName");}
var houseName=$(this).attr("cname");var priceStr=_li.find(".rw4 b.roomPrice").text();var price=priceStr.substr(1);var hId=$(this).attr("hid");_this.showCompareRoom(rId,hotelName,houseName,price,hId);_this.setRoomCookie(rId,hotelName,houseName,price,hId);}else{$("#compareTips").text('提示：一次只能比较两个房型！').fadeIn().fadeOut(1000);}})},showCompareRoom:function(id,hotelName,roomName,price,hId){var com_len=$('<li data='+id+'><div class="des"><p class="name clearfix"><a target="_blank" href="/detail/'+hId+'" title="'+unescape(hotelName)+'">'+unescape(hotelName)+'</a><span class="close">X</span></p><p class="oth clearfix"><span class="volume">'+unescape(roomName)+'</span><span class="price">￥<em>'+price+'</em></span></p></div></li>');com_len.appendTo("#contrastList");hotelPublic.leftDivFloat();this.closeContrastRoom();},closeContrastRoom:function(){var _this=this;$("#contrastList").find("li .close").click(function(){var li=$(this).parents("li").eq(0);_this.removeRoomCookie(li.attr('data'));li.remove();})},hotelContrastFix:function(){$("#scroll_btn").click(function(){if($(this).hasClass("selected")){$(this).removeClass("selected");$("#scrollFixWrap").css({'position':'static'});}else{var top=($(window).height())/2-50;$(this).addClass("selected");$("#scrollFixWrap").css({'position':'fixed','top':top});}})},goCompare:function(){$("#goto-contrast").click(function(){var contrastLen=$("#contrastList").find("li").length;if(contrastLen!=2){$("#compareTips").text('提示：请选择两个房型进行比较！').fadeIn().fadeOut(1000);return false;}else{var ids=[];$("#contrastList").find("li").each(function(){ids.push($(this).attr('data'));});var url='/compare/'+ids.join("/");$(this).find('a').attr('href',url);}})},removeRoomCookie:function(id){if(!$.trim(id)){return false;}
var roomCookieInfo=readCookie(this.compareCookieName);if($.trim(roomCookieInfo)){roomInfo=jQuery.parseJSON($.trim(roomCookieInfo));delete roomInfo[id];createCookie(this.compareCookieName,JSON.stringify(roomInfo),1)}},setRoomCookie:function(id,hotelName,roomName,price,hId){var value={'id':id,'hotelName':escape(hotelName),'roomName':escape(roomName),'price':price,'hId':hId};var roomInfo='';var roomCookieInfo=readCookie(this.compareCookieName);if($.trim(roomCookieInfo)){roomInfo=jQuery.parseJSON($.trim(roomCookieInfo));}else{roomInfo={};}
roomInfo[id]=value;createCookie(this.compareCookieName,JSON.stringify(roomInfo),1)},initCompareList:function(){var _this=this;var roomCookieInfo=readCookie(this.compareCookieName);if($.trim(roomCookieInfo)){var roomInfo=jQuery.parseJSON($.trim(roomCookieInfo));var i=0;$("#contrastList").empty();for(var key in roomInfo){if(i<2){if(roomInfo.hasOwnProperty(key)){var oneRoom=roomInfo[key];_this.showCompareRoom(oneRoom['id'],oneRoom['hotelName'],oneRoom['roomName'],oneRoom['price'],oneRoom['hId']);i++;}}}}},countObjProperties:function(obj){var prop;var propCount=0;for(prop in obj){if(obj.hasOwnProperty(prop)){propCount++;}}
return propCount;}}
var hotelRoomList={init:function(){this.hotelRoomsHover();this.roomMoreDesShow();this.showBookingTips();},hotelRoomsHover:function(){$("#main").find("li.noHouse, li.line2").live({mouseenter:function(){$(this).addClass("hover");},mouseleave:function(){$(this).removeClass("hover");}});},roomMoreDesShow:function(){var _noHouse=$(".noHouse");var _hasHouse=$(".hasHouse");_noHouse.each(function(i,n){$(n).find(".toggle_house").click(function(){$(n).hide().next(".hasHouse").show();})})
_hasHouse.each(function(i,n){$(n).find(".toggle_house").click(function(){$(n).hide().prev(".noHouse").show();})})},showBookingTips:function(){$('.icon_tip').on({mouseenter:function(){utip=$(this).next('.popTip');if(utip.length){$('.popBox').length>0?tip=$('.popBox'):tip=$('<div class="popBox"></div>').appendTo('body');tip.html(utip.html());tip.show();}},mouseleave:function(){tip=$('.popBox')
if(tip.length){tip.hide();}},mousemove:function(e){tip=$('.popBox')
if(tip.length){var mousex=e.pageX+20;var mousey=e.pageY;var tipWidth=tip.outerWidth();var tipHeight=tip.outerHeight();var tipVisX=$(window).width()-(mousex+tipWidth);var tipVisY=$(window).height()-(mousey+tipHeight);if(tipVisX<20){mousex=e.pageX-tipWidth-20;}
if(tipVisY<0){mousey=e.pageY-tipHeight;}
tip.css({top:mousey,left:mousex});}}})}}
var hotelPublic={init:function(){this.leftDivFloat();},leftDivFloat:function(){if($.browser.msie&&$.browser.version=='6.0'){return false;}
var zp_float=$('#scrollFix');if(!zp_float.length){return false;}
var zp_float_hei=zp_float.height();var fpos=zp_float.offset().top;if($("#landmark").length){var bottomOffset=$("#landmark").offset().top;}else{bottomOffset=$("#reasonBox").offset().top;}
var fixed=false;var staticed=false;var zp_float_hide=false;var zp_float_show=false;$(window).on('scroll',function(){if($('#scroll_btn').length){if(!$('#scroll_btn').hasClass('selected')){return;}}
var s_top=$(window).scrollTop();if(s_top>fpos&&!fixed){zp_float.css({'position':'fixed','z-index':100,'top':0});fixed=true;staticed=false;}else if(s_top<=fpos&&!staticed){zp_float.css({'position':'static'});staticed=true;fixed=false;}
if(bottomOffset<=s_top+zp_float_hei+20&&!zp_float_hide){zp_float.css({'position':'absolute','top':bottomOffset-fpos-zp_float_hei-20});zp_float_hide=true;zp_float_show=false;}else if(bottomOffset>s_top+zp_float_hei+20&&!zp_float_show&&s_top>fpos){zp_float.css({'position':'fixed','z-index':100,'top':0});zp_float_show=true;zp_float_hide=false;}});}}
var hotelDate={changeDate:function(){var begin_date=this.dateTransform($("#begin_date").val());var end_date=this.dateTransform($("#end_date").val());},dateTransform:function(data){if(data=='yyyy-mm-dd'){return'';}
var data_arr=data.split('-');var year=parseInt(data_arr[0]);var month=parseInt(data_arr[1]);var day=parseInt(data_arr[2]);month=month<10?'0'+month:month;day=day<10?'0'+day:day;return year+'-'+month+'-'+day;}}
function dateDiff(interval,date1,date2){var objInterval={'D':1000*60*60*24,'H':1000*60*60,'M':1000*60,'S':1000,'T':1};interval=interval.toUpperCase();var dt1=Date.parse(date1.replace(/-/g,'/'));var dt2=Date.parse(date2.replace(/-/g,'/'));try{return Math.round((dt2-dt1)/eval('(objInterval.'+interval+')'));}catch(e){return e.message;}}
function validateDateLong(b,e){var newDate=new Date();var newDateStr=GetDateStr(newDate);var $checkindateDom=b||$('#begin_date');var $checkoutdateDom=e||$('#end_date');var $checkindate=$checkindateDom.val();var $checkoutdate=$checkoutdateDom.val();var _left=$checkoutdateDom.offset().left;var _top=$checkoutdateDom.offset().top+40;if(dateDiff('D',newDateStr,$checkoutdate)>60){$checkoutdateDom.addClass("err");var com_bug=$('<div id="com_bug" class="com_bug"><div class="w">如果您需预订'+$checkoutdate+'的酒店，请致电：4007-999-999，我们会竭诚为您服务。</div></div>');com_bug.appendTo("body");com_bug.css({top:_top,left:_left});com_bug.click(function(e){stopPropagation(e);});return false;}else if(dateDiff('D',$checkindate,$checkoutdate)>20){$checkoutdateDom.addClass("err");var com_bug=$('<div id="com_bug" class="com_bug"><div class="w">如果您需要在酒店入住20天以上，请致电：4007-999-999，我们会竭诚为您服务。</div></div>')
com_bug.appendTo("body");com_bug.css({top:_top,left:_left});com_bug.click(function(e){stopPropagation(e);});return false;}
return true;}
function cleanParams(s){return s.replace("'","").replace('"','').replace("<","").replace(">","").replace("/","").replace(";","").replace("@","").replace("%","").replace("*","").replace("&","");}
function cleanCityName(c){var pattern=new RegExp("^[\u4E00-\u9FA5]+$");var cs=c.split('');var rt=[];for(var i in cs){if(pattern.test(cs[i])){rt.push(cs[i]);}}
return rt.join('');}
function stopPropagation(e){e=e||window.event;if(e.stopPropagation){e.stopPropagation();}else{e.cancelBubble=true;}}
function GetDateStr(pdate){var dd=pdate;var y=dd.getYear();y=y%100;y=((y<50)?(2000+y):(1900+y));var m=dd.getMonth()+1;var d=dd.getDate();return y+"-"+m+"-"+d;}
function readCookie(name){var nameEQ=name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameEQ)==0)return c.substring(nameEQ.length,c.length);}
return null;}
function createCookie(name,value,days){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}
else var expires="";document.cookie=name+"="+value+expires+"; path=/";}
function getCurrentPath(){var pathname=window.location.pathname.toLowerCase();if(pathname.indexOf('/list')>-1){return'list';}else if(pathname.indexOf('/detail')>-1){return'detail';}else if(pathname.indexOf('/compare')>-1){return'compare';}else if(pathname.indexOf('/ajax')>-1){return'ajax';}
else if(pathname==='/'){return'index';}};;(function(){var ChatEntry={};var available={'product':[6],'order':[],'channel':[6],};ChatEntry.checkEntry=function(entranceType,entranceId){return available[entranceType].indexOf(entranceId)>-1;};ChatEntry.openChat=function(entranceType,entranceId,entryParam){if(!this.checkEntry(entranceType,entranceId)){return;}
if(typeof _gaq!='undefined'){_gaq.push(['_trackEvent','在线客服按钮_1','','']);}
entryParam=entryParam||{};var paramStr=Object.keys(entryParam).reduce(function(pre,cur,index,array){var res=pre+(entryParam[cur]?((index>0?'&':'')+cur+'='+entryParam[cur]):'');return res;},'');;var livechatUrl=encodeURI('http://dynamic.m.tuniu.com/livechat?'+paramStr);window.open(livechatUrl,'在线客服','width=640, height=515, top=100, left=500, toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no');};if(typeof module!=='undefined'&&typeof exports==='object'){module.exports=ChatEntry;}else if(typeof define==='function'&&(define.amd||define.cmd)){define(function(){return ChatEntry;});}else{this.ChatEntry=ChatEntry;}}).call(this||(typeof window!=='undefined'?window:global));